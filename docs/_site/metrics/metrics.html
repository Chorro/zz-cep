<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>CEP : Listeners</title>
        <meta name="description" content="is a complex engine processing based on Kafka and Siddhi">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/zz-cep/css/syntax.css">
        <link rel="stylesheet" href="/zz-cep/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <h4><a class="brand" href="/zz-cep/">CEP</a>
    <small>is a complex engine processing based on Kafka and Siddhi</small>
</h4>

                </div>
            </div>

            <div class="row">
                
                
                    <div id="navigation" class="col-sm-2">
                        <ul class="nav nav-list">
    <li><a href="/zz-cep/">Home</a></li>
    
        
        

        
    
        
        

        
            
                <li class="nav-header">Getting Started</li>
            
            <li data-order=""><a href="/zz-cep/getting/base-tutorial.html">Base tutorial</a></li>
        
    
        
        

        
            
                <li class="nav-header">Configuration</li>
            
            <li data-order="2"><a href="/zz-cep/conf/stream-configuration.html">Stream Configuration</a></li>
        
            
            <li data-order="1"><a href="/zz-cep/conf/base-configuration.html">Base Configuration</a></li>
        
    
        
        

        
            
                <li class="nav-header">Bootstrapper</li>
            
            <li data-order="1"><a href="/zz-cep/bootstrapper/definition-boostrapper.html">Definition</a></li>
        
            
            <li data-order="2"><a href="/zz-cep/bootstrapper/file-boostrapper.html">File Bootstrapper</a></li>
        
            
            <li data-order="3"><a href="/zz-cep/bootstrapper/kafka-boostrapper.html">Kafka Bootstrapper</a></li>
        
    
        
        

        
    
        
        

        
            
                <li class="nav-header">Docker</li>
            
            <li data-order=""><a href="/zz-cep/docker/docker-intro.html">Docker Intro</a></li>
        
    
        
        

        
            
                <li class="nav-header">Metrics</li>
            
            <li data-order="2"><a href="/zz-cep/metrics/metrics.html">Listeners</a></li>
        
            
            <li data-order="1"><a href="/zz-cep/metrics/configuration.html">Configuration</a></li>
        
    
        
        

        
            
                <li class="nav-header">Internals</li>
            
            <li data-order=""><a href="/zz-cep/internals/topics.html">Topics</a></li>
        
    
        
        

        
    
        
        

        
            
                <li class="nav-header">Limitations</li>
            
            <li data-order=""><a href="/zz-cep/limits/currently-limitations.html">Current limitations</a></li>
        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                    </div>

                    <div id="content" class="col-sm-10">
                        <div class="page-header">
    <h2>Listeners
        
    </h2>
</div>

<p>The listeners are the process that listen the reported metrics and do something with them. You can have multiple listeners at the same time. Currently, the Cep service supports two listener metrics:</p>

<h4 id="consolemetriclistener">ConsoleMetricListener</h4>

<p>This listener <code class="highlighter-rouge">io.wizzie.ks.metrics.ConsoleMetricListener</code> send the transform the metrics to JSON and prints them into the log file using the log4j. The metric format is:</p>
<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"timestamp"</span><span class="p">:</span><span class="mi">123456789</span><span class="p">,</span><span class="w"> </span><span class="nt">"monitor"</span><span class="p">:</span><span class="s2">"heap-memory"</span><span class="p">,</span><span class="w"> </span><span class="nt">"value"</span><span class="p">:</span><span class="mi">12345</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h4 id="kafkametriclistener">KafkaMetricListener</h4>
<p>This listener <code class="highlighter-rouge">io.wizzie.ks.cep.metrics.KafkaMetricListener</code> send the transform the metrics to JSON and sends them into the Kafka topic. The metric format is:</p>
<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"timestamp"</span><span class="p">:</span><span class="mi">123456789</span><span class="p">,</span><span class="w"> </span><span class="nt">"monitor"</span><span class="p">:</span><span class="s2">"heap-memory"</span><span class="p">,</span><span class="w"> </span><span class="nt">"value"</span><span class="p">:</span><span class="mi">12345</span><span class="p">,</span><span class="w"> </span><span class="nt">"app_id"</span><span class="p">:</span><span class="s2">"MY_KAFKA_STREAMS_APP_ID"</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>This listener adds a new property to specify the metrics Kafka topic <code class="highlighter-rouge">metric.kafka.topic</code>, by default is <code class="highlighter-rouge">__cep_metrics</code></p>

<h4 id="custom-listeners">Custom Listeners</h4>
<p>You can made new listeners to do this you need to implement the <a href="https://github.com/wizzie-io/zz-cep/blob/master/service/src/main/java/io/wizzie/ks/cep/metrics/MetricListener.java">MetricListener Class</a>. On this class you receive the metric on the method <code class="highlighter-rouge">void updateMetric(String metricName, Object metricValue);</code></p>


                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    Documentation for <a href="https://github.com/wizzie-io/zz-cep">CEP</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
    </body>
</html>
